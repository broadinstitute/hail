To get kubectl credentials for a GKE cluster:

$ gcloud container clusters get-credentials <cluster>

To authorize docker to push to GCR:

$ gcloud auth configure-docker

To run batch locally, using the local kube credentials:

$ docker run -i -v $HOME/.kube:/root/.kube -p 5000:5000 -t batch

On OSX, the port will be accessible on the docker-machine:

$(docker-machine ip default):5000

Get a shell in a running pod:

$ kubectl exec -it <pod> -- /bin/sh

Hit a Flask REST endpoint with Curl:

$ curl -X POST -H "Content-Type: application/json" -d <data> <url>

$ curl -X POST -H "Content-Type: application/json" -d '{"name": "batchtest", "image": "gcr.io/broad-ctsa/true:1.0.0"}' batch/schedule

Give default:default serviceaccount cluster-admin privileges:

$ kubectl create clusterrolebinding cluster-admin-default --clusterrole cluster-admin --serviceaccount=default:default

Run an image in a new pod:

$ kubectl run <name> --restart=Never --image <image. -- <cmd>

For example, run a shell in an new pod:

$ kubectl run -i --tty apline --image=alpine --restart=Never -- sh
